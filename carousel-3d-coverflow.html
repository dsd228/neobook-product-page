<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carrusel 3D Coverflow - Premium Design</title>
  <style>
    /* ============================================
       RESET Y CONFIGURACI√ìN BASE
       ============================================ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      overflow-x: hidden;
    }

    /* ============================================
       CONTENEDOR PRINCIPAL CON PERSPECTIVA 3D
       - Establece el punto de vista para el efecto 3D
       - La perspectiva determina la profundidad visual
       ============================================ */
    .carousel-wrapper {
      position: relative;
      width: 100%;
      max-width: 1200px;
      height: 600px;
      perspective: 1200px; /* Perspectiva para el efecto 3D */
      perspective-origin: 50% 50%; /* Punto de fuga centrado */
    }

    /* ============================================
       TRACK INTERNO CON PRESERVE-3D
       - Mantiene las transformaciones 3D en los hijos
       - Posicionamiento absoluto para centrado
       ============================================ */
    .carousel-track {
      position: absolute;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d; /* Crucial para mantener el espacio 3D */
      transform: translateZ(0); /* Inicializa el contexto 3D */
    }

    /* ============================================
       CARDS DEL CARRUSEL
       - Tama√±o: 320x400px seg√∫n especificaci√≥n
       - Posicionadas en el centro mediante translate(-50%, -50%)
       - Optimizaci√≥n de renderizado con will-change
       ============================================ */
    .carousel-card {
      position: absolute;
      /* Centrado mediante translate(-50%, -50%) como especificado */
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      
      /* Tama√±o de las cards seg√∫n requisitos */
      width: 320px;
      height: 400px;
      
      /* Estilo visual premium */
      border-radius: 20px;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      
      /* Sombras profundas para efecto premium */
      box-shadow: 
        0 30px 80px rgba(0, 0, 0, 0.4),
        0 10px 30px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1); /* Sutil inset */
      
      /* Transici√≥n suave con cubic-bezier especificado */
      transition: 
        transform 0.7s cubic-bezier(0.22, 0.61, 0.36, 1),
        opacity 0.7s cubic-bezier(0.22, 0.61, 0.36, 1),
        filter 0.7s cubic-bezier(0.22, 0.61, 0.36, 1),
        box-shadow 0.7s cubic-bezier(0.22, 0.61, 0.36, 1),
        z-index 0s 0.35s; /* z-index cambia en el medio de la transici√≥n */
      
      /* Optimizaci√≥n de rendimiento */
      will-change: transform, opacity, filter; /* Solo propiedades que cambian */
      backface-visibility: hidden; /* Evita renderizado de cara trasera */
      
      /* Cursor indica que es clickeable */
      cursor: pointer;
      
      /* Previene selecci√≥n de texto */
      user-select: none;
    }

    /* Overlay sutil para mejorar legibilidad si hay texto */
    .carousel-card::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 20px;
      background: linear-gradient(
        135deg,
        rgba(255, 255, 255, 0.1) 0%,
        rgba(255, 255, 255, 0) 50%,
        rgba(0, 0, 0, 0.2) 100%
      );
      pointer-events: none;
    }

    /* ============================================
       ESTADO ACTIVO DE LA CARD
       - Elevaci√≥n con translateZ positivo
       - Scale para mayor tama√±o
       - Sin blur ni opacidad reducida
       ============================================ */
    .carousel-card.active {
      /* Elevaci√≥n y escala para destacar */
      transform: 
        translate(-50%, -50%)
        translateZ(200px)
        scale(1.15);
      
      /* M√°xima opacidad y sin blur */
      opacity: 1;
      filter: blur(0px) brightness(1);
      
      /* Sombra m√°s prominente */
      box-shadow: 
        0 40px 100px rgba(0, 0, 0, 0.5),
        0 15px 40px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
      
      /* z-index alto para estar al frente */
      z-index: 100;
    }

    /* ============================================
       CARDS NO ACTIVAS
       - Opacidad reducida seg√∫n la distancia
       - Blur sutil para enfatizar la activa
       ============================================ */
    .carousel-card:not(.active) {
      opacity: 0.6;
      filter: blur(2px) brightness(0.8);
    }

    /* ============================================
       INSTRUCCIONES DE USO
       - Informaci√≥n para el usuario
       ============================================ */
    .instructions {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 16px 32px;
      border-radius: 50px;
      font-size: 14px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      text-align: center;
      z-index: 1000;
    }

    .instructions strong {
      display: block;
      margin-bottom: 8px;
      font-size: 16px;
    }

    /* ============================================
       INDICADOR DE POSICI√ìN
       - Muestra qu√© card est√° activa
       ============================================ */
    .position-indicator {
      position: fixed;
      top: 40px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      z-index: 1000;
    }

    .position-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transition: all 0.3s cubic-bezier(0.22, 0.61, 0.36, 1);
    }

    .position-dot.active {
      background: white;
      transform: scale(1.5);
    }

    /* ============================================
       RESPONSIVE DESIGN
       - Ajustes para pantallas peque√±as
       ============================================ */
    @media (max-width: 768px) {
      .carousel-wrapper {
        height: 500px;
        perspective: 800px;
      }

      .carousel-card {
        width: 260px;
        height: 340px;
      }

      .instructions {
        font-size: 12px;
        padding: 12px 24px;
        bottom: 20px;
      }

      .instructions strong {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <!-- Indicador de posici√≥n -->
  <div class="position-indicator" id="positionIndicator"></div>

  <!-- Contenedor principal del carrusel -->
  <div class="carousel-wrapper">
    <!-- Track con preserve-3d para mantener transformaciones 3D -->
    <div class="carousel-track" id="carouselTrack">
      <!-- Las cards se generar√°n din√°micamente con JavaScript -->
    </div>
  </div>

  <!-- Instrucciones de uso -->
  <div class="instructions">
    <strong>üñ±Ô∏è Navegaci√≥n</strong>
    Usa la rueda del mouse o haz clic en cualquier card
  </div>

  <script>
    /* ============================================
       CONFIGURACI√ìN DEL CARRUSEL
       ============================================ */
    
    // Funci√≥n para generar SVG placeholder con gradientes √∫nicos
    // Estas im√°genes son f√°cilmente reemplazables con URLs reales
    function generatePlaceholderImage(index, total) {
      const colors = [
        ['#667eea', '#764ba2'], // P√∫rpura
        ['#f093fb', '#f5576c'], // Rosa
        ['#4facfe', '#00f2fe'], // Azul
        ['#43e97b', '#38f9d7'], // Verde
        ['#fa709a', '#fee140'], // Naranja
        ['#30cfd0', '#330867'], // Turquesa
        ['#a8edea', '#fed6e3']  // Pastel
      ];
      
      const [color1, color2] = colors[index % colors.length];
      
      return `data:image/svg+xml,${encodeURIComponent(`
        <svg xmlns="http://www.w3.org/2000/svg" width="320" height="400" viewBox="0 0 320 400">
          <defs>
            <linearGradient id="grad${index}" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:${color1};stop-opacity:1" />
              <stop offset="100%" style="stop-color:${color2};stop-opacity:1" />
            </linearGradient>
          </defs>
          <rect width="320" height="400" fill="url(#grad${index})"/>
          <circle cx="160" cy="150" r="60" fill="rgba(255,255,255,0.2)"/>
          <text x="160" y="250" font-family="Arial, sans-serif" font-size="48" font-weight="bold" 
                fill="rgba(255,255,255,0.9)" text-anchor="middle">Card ${index + 1}</text>
          <text x="160" y="280" font-family="Arial, sans-serif" font-size="16" 
                fill="rgba(255,255,255,0.7)" text-anchor="middle">Premium Design</text>
        </svg>
      `)}`;
    }
    
    // Array de im√°genes del carrusel
    // Generar 7 cards con placeholders
    const carouselImages = Array.from({ length: 7 }, (_, i) => generatePlaceholderImage(i, 7));
    
    /* 
       PARA REEMPLAZAR CON TUS PROPIAS IM√ÅGENES:
       ------------------------------------------
       Opci√≥n 1 - URLs externas:
       const carouselImages = [
         'https://tu-sitio.com/imagen1.jpg',
         'https://tu-sitio.com/imagen2.jpg',
         'https://tu-sitio.com/imagen3.jpg',
       ];
       
       Opci√≥n 2 - Rutas locales:
       const carouselImages = [
         './images/producto1.jpg',
         './images/producto2.jpg',
         './images/producto3.jpg',
       ];
       
       Las im√°genes se ajustar√°n autom√°ticamente con background-size: cover
    */

    // Referencias al DOM
    const track = document.getElementById('carouselTrack');
    const positionIndicator = document.getElementById('positionIndicator');
    
    // Estado del carrusel
    let currentIndex = 0; // √çndice de la card activa
    let cards = []; // Array de elementos card
    let isAnimating = false; // Flag para prevenir m√∫ltiples animaciones simult√°neas

    /* ============================================
       INICIALIZACI√ìN DEL CARRUSEL
       - Crea las cards din√°micamente
       - Configura im√°genes de fondo
       - A√±ade event listeners
       ============================================ */
    function initCarousel() {
      // Crear cards para cada imagen
      carouselImages.forEach((imageUrl, index) => {
        const card = document.createElement('div');
        card.className = 'carousel-card';
        card.style.backgroundImage = `url('${imageUrl}')`;
        card.dataset.index = index;
        
        // Event listener para click en la card
        card.addEventListener('click', () => handleCardClick(index));
        
        track.appendChild(card);
        cards.push(card);
      });

      // Crear indicadores de posici√≥n
      carouselImages.forEach((_, index) => {
        const dot = document.createElement('div');
        dot.className = 'position-dot';
        dot.dataset.index = index;
        positionIndicator.appendChild(dot);
      });

      // Posicionar cards inicialmente
      updateCarousel();
    }

    /* ============================================
       ACTUALIZACI√ìN DEL CARRUSEL
       - Calcula posiciones 3D para cada card
       - Aplica transformaciones seg√∫n √≠ndice relativo
       - Gestiona z-index din√°micamente
       ============================================ */
    function updateCarousel() {
      const totalCards = cards.length;

      cards.forEach((card, index) => {
        // Calcular √≠ndice relativo al centro (card activa)
        // Esto determina la posici√≥n y rotaci√≥n de cada card
        const relativeIndex = index - currentIndex;
        
        // Normalizar el √≠ndice para el efecto circular
        // Esto permite que las cards "envuelvan" alrededor
        let normalizedIndex = relativeIndex;
        if (relativeIndex > totalCards / 2) {
          normalizedIndex = relativeIndex - totalCards;
        } else if (relativeIndex < -totalCards / 2) {
          normalizedIndex = relativeIndex + totalCards;
        }

        // Determinar si es la card activa
        const isActive = normalizedIndex === 0;

        /* ============================================
           C√ÅLCULO DE TRANSFORMACIONES 3D
           ============================================ */
        
        if (isActive) {
          // Card activa: centrada, elevada y escalada
          card.style.transform = `
            translate(-50%, -50%)
            translateX(0px)
            translateZ(200px)
            rotateY(0deg)
            scale(1.15)
          `;
          card.classList.add('active');
          // z-index m√°s alto para estar al frente
          card.style.zIndex = 100;
        } else {
          // Cards laterales: desplazadas, rotadas y con menos profundidad
          
          // translateX proporcional al √≠ndice (separaci√≥n horizontal)
          const translateX = normalizedIndex * 280; // Espaciado entre cards
          
          // rotateY seg√∫n posici√≥n (positivo/negativo)
          const rotateY = normalizedIndex * 35; // √Ångulo de rotaci√≥n
          
          // translateZ negativo para alejar del usuario
          const translateZ = -Math.abs(normalizedIndex) * 100;
          
          // Escala reducida para cards lejanas
          const scale = 1 - Math.abs(normalizedIndex) * 0.1;
          
          card.style.transform = `
            translate(-50%, -50%)
            translateX(${translateX}px)
            translateZ(${translateZ}px)
            rotateY(${rotateY}deg)
            scale(${scale})
          `;
          
          card.classList.remove('active');
          
          // z-index calculado seg√∫n cercan√≠a al centro
          // Cards m√°s cercanas tienen mayor z-index
          card.style.zIndex = 50 - Math.abs(normalizedIndex);
        }
      });

      // Actualizar indicadores de posici√≥n
      updatePositionIndicators();
    }

    /* ============================================
       ACTUALIZAR INDICADORES VISUALES
       - Muestra qu√© card est√° activa
       ============================================ */
    function updatePositionIndicators() {
      const dots = positionIndicator.querySelectorAll('.position-dot');
      dots.forEach((dot, index) => {
        if (index === currentIndex) {
          dot.classList.add('active');
        } else {
          dot.classList.remove('active');
        }
      });
    }

    /* ============================================
       NAVEGACI√ìN MEDIANTE CLICK
       - Permite activar cualquier card clicke√°ndola
       - Movimiento suave hasta la posici√≥n objetivo
       ============================================ */
    function handleCardClick(targetIndex) {
      if (isAnimating || targetIndex === currentIndex) return;
      
      isAnimating = true;
      currentIndex = targetIndex;
      updateCarousel();
      
      // Permitir nueva animaci√≥n despu√©s del tiempo de transici√≥n
      setTimeout(() => {
        isAnimating = false;
      }, 700); // Coincide con la duraci√≥n de la transici√≥n CSS
    }

    /* ============================================
       NAVEGACI√ìN SIGUIENTE/ANTERIOR
       - Funciones para moverse en el carrusel
       - Consideran el efecto circular
       ============================================ */
    function navigateNext() {
      if (isAnimating) return;
      
      isAnimating = true;
      currentIndex = (currentIndex + 1) % cards.length;
      updateCarousel();
      
      setTimeout(() => {
        isAnimating = false;
      }, 700);
    }

    function navigatePrev() {
      if (isAnimating) return;
      
      isAnimating = true;
      currentIndex = (currentIndex - 1 + cards.length) % cards.length;
      updateCarousel();
      
      setTimeout(() => {
        isAnimating = false;
      }, 700);
    }

    /* ============================================
       INTERACCI√ìN CON SCROLL DEL MOUSE
       - Desplazamiento mediante rueda del mouse
       - Movimiento sutil para evitar mareos
       - Throttling para prevenir scroll excesivo
       ============================================ */
    let scrollTimeout = null;
    
    function handleWheel(event) {
      // Prevenir scroll de p√°gina
      event.preventDefault();
      
      // Debounce del scroll para movimiento m√°s controlado
      if (scrollTimeout) {
        clearTimeout(scrollTimeout);
      }
      
      scrollTimeout = setTimeout(() => {
        // Determinar direcci√≥n del scroll
        // deltaY positivo = scroll hacia abajo = siguiente
        // deltaY negativo = scroll hacia arriba = anterior
        if (event.deltaY > 0) {
          navigateNext();
        } else if (event.deltaY < 0) {
          navigatePrev();
        }
      }, 50); // Peque√±o delay para suavizar el scroll
    }

    // Event listener para scroll del mouse
    document.addEventListener('wheel', handleWheel, { passive: false });

    /* ============================================
       NAVEGACI√ìN CON TECLADO (ACCESIBILIDAD)
       - Flechas izquierda/derecha para navegar
       - Mejora la accesibilidad del componente
       ============================================ */
    document.addEventListener('keydown', (event) => {
      if (event.key === 'ArrowLeft') {
        navigatePrev();
      } else if (event.key === 'ArrowRight') {
        navigateNext();
      }
    });

    /* ============================================
       TOUCH/SWIPE SUPPORT (OPCIONAL)
       - Soporte b√°sico para dispositivos t√°ctiles
       ============================================ */
    let touchStartX = 0;
    let touchEndX = 0;

    track.addEventListener('touchstart', (event) => {
      touchStartX = event.changedTouches[0].screenX;
    });

    track.addEventListener('touchend', (event) => {
      touchEndX = event.changedTouches[0].screenX;
      handleSwipe();
    });

    function handleSwipe() {
      const swipeThreshold = 50; // M√≠nimo desplazamiento para considerar swipe
      
      if (touchEndX < touchStartX - swipeThreshold) {
        // Swipe hacia la izquierda
        navigateNext();
      }
      
      if (touchEndX > touchStartX + swipeThreshold) {
        // Swipe hacia la derecha
        navigatePrev();
      }
    }

    /* ============================================
       INICIALIZAR AL CARGAR LA P√ÅGINA
       ============================================ */
    initCarousel();
  </script>
</body>
</html>
